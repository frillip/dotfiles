#!/bin/bash
if [ $# -eq 0 ]; then
    echo "Open files that contain given matches in \$EDITOR, selected by fzf"
    echo
    rg 2>&1 | sed "s+rg +rgfzf +g"
    exit 1
fi

# tty required, see GNU xargs man page
# Note that BSD args does not allow the delimiter to be \n so \0 must be used with the -0 option.
rg --color=always "$@" | fzf --multi --ansi | cut -d ':' -f 1 | tr '\n' '\0' | exec xargs -0 sh -c 'exec $0 "$@" </dev/tty' $EDITOR
